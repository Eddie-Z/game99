{"ast":null,"code":"import React, { useEffect, useState } from 'react';\nimport { compareValues } from './utils';\nimport { createDeckAndDraw, drawCardFromDeck } from './api';\nexport const useBoardGame = () => {\n  //states\n  //player1\n  const [{\n    cardImageUrl,\n    cardInHand\n  }, setCardState] = useState({\n    cardInHand: null,\n    cardImageUrl: null\n  }); //player2\n\n  const [{\n    cardImageUrl_2,\n    cardInHand_2\n  }, setCardState_2] = useState({\n    cardInHand_2: null,\n    cardImageUrl_2: null\n  });\n  const [deckId, setDeckId] = useState(null);\n  const [result, setResult] = useState(null);\n  const [score, setScore] = useState(null); //turn\n\n  const [turn, setTurn] = useState(true); //use effect sychonrous to prevent race conditions\n\n  useEffect(() => {\n    const fetchCardandDeck = async () => {\n      const {\n        deckId,\n        cardsArray\n      } = await createDeckAndDraw();\n      console.log({\n        deckId,\n        cardsArray\n      }); //convert object to array of values\n\n      const cards = cardsArray.map(obj => {\n        return obj.value;\n      }); //convert object to array of images\n\n      const images = cardsArray.map(obj => {\n        return obj.image;\n      });\n      setCardState({\n        cardInHand: cards,\n        cardImageUrl: images\n      });\n      setDeckId(deckId);\n    };\n\n    fetchCardandDeck();\n  }, []);\n  useEffect(() => {\n    const fetchNewCard = async () => {\n      const {\n        value,\n        image\n      } = await drawCardFromDeck(deckId);\n      setCardState({\n        cardInHand: [...cardInHand, value],\n        cardImageUrl: [...cardImageUrl, image]\n      });\n    };\n\n    fetchNewCard();\n  }, [turn]); // const onButtonClick = async (event) =>{\n  //     const bet=event.target.name\n  //     const {value,image} = await drawCardFromDeck(deckId);\n  //     const result = compareValues({\n  //         previousCardValue: cardValue,\n  //         currentCardValue: value,\n  //         bet\n  //     })\n  //     setCardState({\n  //         cardImageUrl:image,\n  //         cardValue:value\n  //     })\n  //     setResult(result)\n  // }\n\n  const onCardClick = event => {\n    let srcImgCard = event.target.src;\n    let pos = cardImageUrl.indexOf(srcImgCard);\n    let selectedCardValue = cardInHand[pos];\n    let updatedScore = Number(score) + Number(selectedCardValue);\n\n    if (turn) {\n      //draw another card\n      //update score\n      setScore(updatedScore); //remove card from objects\n\n      setCardState({\n        cardInHand: cardInHand.filter(item => item != selectedCardValue),\n        cardImageUrl: cardImageUrl.filter(item => item != srcImgCard)\n      }); //change turn\n\n      setTurn(!turn);\n    }\n  };\n\n  return {\n    score,\n    cardImageUrl,\n    //onButtonClick,\n    onCardClick,\n    result\n  };\n};","map":{"version":3,"sources":["/Users/eddiezheng/Documents/GitHub/99/card/cardgame/src/cardGameBoard.state.js"],"names":["React","useEffect","useState","compareValues","createDeckAndDraw","drawCardFromDeck","useBoardGame","cardImageUrl","cardInHand","setCardState","cardImageUrl_2","cardInHand_2","setCardState_2","deckId","setDeckId","result","setResult","score","setScore","turn","setTurn","fetchCardandDeck","cardsArray","console","log","cards","map","obj","value","images","image","fetchNewCard","onCardClick","event","srcImgCard","target","src","pos","indexOf","selectedCardValue","updatedScore","Number","filter","item"],"mappings":"AAAA,OAAOA,KAAP,IAAeC,SAAf,EAAyBC,QAAzB,QAAwC,OAAxC;AACA,SAASC,aAAT,QAA8B,SAA9B;AACA,SAAQC,iBAAR,EAA2BC,gBAA3B,QAAkD,OAAlD;AAEA,OAAO,MAAMC,YAAY,GAAG,MAAM;AAE9B;AACA;AACA,QAAM,CAAC;AAACC,IAAAA,YAAD;AAAcC,IAAAA;AAAd,GAAD,EAA4BC,YAA5B,IAA4CP,QAAQ,CAAC;AACvDM,IAAAA,UAAU,EAAC,IAD4C;AAEvDD,IAAAA,YAAY,EAAC;AAF0C,GAAD,CAA1D,CAJ8B,CAQ9B;;AACA,QAAM,CAAC;AAACG,IAAAA,cAAD;AAAgBC,IAAAA;AAAhB,GAAD,EAAgCC,cAAhC,IAAkDV,QAAQ,CAAC;AAC7DS,IAAAA,YAAY,EAAC,IADgD;AAE7DD,IAAAA,cAAc,EAAC;AAF8C,GAAD,CAAhE;AAKA,QAAM,CAACG,MAAD,EAASC,SAAT,IAAoBZ,QAAQ,CAAC,IAAD,CAAlC;AACA,QAAM,CAACa,MAAD,EAAQC,SAAR,IAAmBd,QAAQ,CAAC,IAAD,CAAjC;AACA,QAAM,CAACe,KAAD,EAAOC,QAAP,IAAiBhB,QAAQ,CAAC,IAAD,CAA/B,CAhB8B,CAkB9B;;AACA,QAAM,CAACiB,IAAD,EAAMC,OAAN,IAAelB,QAAQ,CAAC,IAAD,CAA7B,CAnB8B,CAqB9B;;AACAD,EAAAA,SAAS,CAAC,MAAI;AACV,UAAMoB,gBAAgB,GAAG,YAAW;AAChC,YAAM;AAACR,QAAAA,MAAD;AAAQS,QAAAA;AAAR,UAAsB,MAAMlB,iBAAiB,EAAnD;AACAmB,MAAAA,OAAO,CAACC,GAAR,CAAY;AAACX,QAAAA,MAAD;AAAQS,QAAAA;AAAR,OAAZ,EAFgC,CAIhC;;AACC,YAAMG,KAAK,GAAGH,UAAU,CAACI,GAAX,CAAeC,GAAG,IAAI;AAChC,eAAOA,GAAG,CAACC,KAAX;AACH,OAFa,CAAd,CAL+B,CAS/B;;AACA,YAAMC,MAAM,GAAGP,UAAU,CAACI,GAAX,CAAeC,GAAG,IAAI;AAClC,eAAOA,GAAG,CAACG,KAAX;AACH,OAFe,CAAf;AAIDrB,MAAAA,YAAY,CAAC;AACTD,QAAAA,UAAU,EAACiB,KADF;AAETlB,QAAAA,YAAY,EAACsB;AAFJ,OAAD,CAAZ;AAIAf,MAAAA,SAAS,CAACD,MAAD,CAAT;AACH,KAnBD;;AAoBAQ,IAAAA,gBAAgB;AACnB,GAtBQ,EAsBP,EAtBO,CAAT;AAwBApB,EAAAA,SAAS,CAAC,MAAI;AACN,UAAM8B,YAAY,GAAG,YAAW;AAC5B,YAAM;AAACH,QAAAA,KAAD;AAAOE,QAAAA;AAAP,UAAgB,MAAMzB,gBAAgB,CAACQ,MAAD,CAA5C;AACAJ,MAAAA,YAAY,CAAC;AACTD,QAAAA,UAAU,EAAC,CAAC,GAAGA,UAAJ,EAAeoB,KAAf,CADF;AAETrB,QAAAA,YAAY,EAAC,CAAC,GAAGA,YAAJ,EAAiBuB,KAAjB;AAFJ,OAAD,CAAZ;AAKH,KAPD;;AAQAC,IAAAA,YAAY;AACnB,GAVQ,EAUP,CAACZ,IAAD,CAVO,CAAT,CA9C8B,CA0D9B;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;;AAEA,QAAMa,WAAW,GAAIC,KAAD,IAAW;AAC3B,QAAIC,UAAU,GAAGD,KAAK,CAACE,MAAN,CAAaC,GAA9B;AACA,QAAIC,GAAG,GAAG9B,YAAY,CAAC+B,OAAb,CAAqBJ,UAArB,CAAV;AACA,QAAIK,iBAAiB,GAAG/B,UAAU,CAAC6B,GAAD,CAAlC;AAEA,QAAIG,YAAY,GAAGC,MAAM,CAACxB,KAAD,CAAN,GAAcwB,MAAM,CAACF,iBAAD,CAAvC;;AAEA,QAAGpB,IAAH,EACA;AACI;AAEI;AACJD,MAAAA,QAAQ,CAACsB,YAAD,CAAR,CAJJ,CAMI;;AACA/B,MAAAA,YAAY,CAAC;AACTD,QAAAA,UAAU,EAACA,UAAU,CAACkC,MAAX,CAAkBC,IAAI,IAAIA,IAAI,IAAEJ,iBAAhC,CADF;AAEThC,QAAAA,YAAY,EAACA,YAAY,CAACmC,MAAb,CAAoBC,IAAI,IAAIA,IAAI,IAAET,UAAlC;AAFJ,OAAD,CAAZ,CAPJ,CAYI;;AACAd,MAAAA,OAAO,CAAC,CAACD,IAAF,CAAP;AACH;AAEJ,GAxBD;;AA2BA,SAAO;AACHF,IAAAA,KADG;AAEHV,IAAAA,YAFG;AAGH;AACAyB,IAAAA,WAJG;AAKHjB,IAAAA;AALG,GAAP;AAOH,CA/GM","sourcesContent":["import React, {useEffect,useState} from 'react'\nimport { compareValues } from './utils'\nimport {createDeckAndDraw, drawCardFromDeck} from './api'\n\nexport const useBoardGame = () => {\n\n    //states\n    //player1\n    const [{cardImageUrl,cardInHand}, setCardState] = useState({\n        cardInHand:null,\n        cardImageUrl:null\n    })\n    //player2\n    const [{cardImageUrl_2,cardInHand_2}, setCardState_2] = useState({\n        cardInHand_2:null,\n        cardImageUrl_2:null\n    })\n\n    const [deckId, setDeckId]=useState(null)\n    const [result,setResult]=useState(null)\n    const [score,setScore]=useState(null)\n\n    //turn\n    const [turn,setTurn]=useState(true)\n\n    //use effect sychonrous to prevent race conditions\n    useEffect(()=>{\n        const fetchCardandDeck = async () =>{\n            const {deckId,cardsArray} = await createDeckAndDraw();\n            console.log({deckId,cardsArray})\n\n            //convert object to array of values\n             const cards = cardsArray.map(obj => {\n                 return obj.value\n             })\n\n             //convert object to array of images\n             const images = cardsArray.map(obj => {\n                return obj.image\n            })\n            \n            setCardState({\n                cardInHand:cards,\n                cardImageUrl:images\n            })\n            setDeckId(deckId);\n        }\n        fetchCardandDeck();\n    },[])\n\n    useEffect(()=>{\n            const fetchNewCard = async () =>{\n                const {value,image} = await drawCardFromDeck(deckId);\n                setCardState({\n                    cardInHand:[...cardInHand,value],\n                    cardImageUrl:[...cardImageUrl,image]\n                })\n              \n            }\n            fetchNewCard();\n    },[turn])\n\n    // const onButtonClick = async (event) =>{\n    //     const bet=event.target.name\n    //     const {value,image} = await drawCardFromDeck(deckId);\n    \n        \n    //     const result = compareValues({\n    //         previousCardValue: cardValue,\n    //         currentCardValue: value,\n    //         bet\n    //     })\n \n    //     setCardState({\n    //         cardImageUrl:image,\n    //         cardValue:value\n    //     })\n        \n    //     setResult(result)\n    // }\n\n    const onCardClick = (event) => {\n        let srcImgCard = event.target.src\n        let pos = cardImageUrl.indexOf(srcImgCard)\n        let selectedCardValue = cardInHand[pos]\n\n        let updatedScore = Number(score)+Number(selectedCardValue)\n\n        if(turn)\n        {\n            //draw another card\n\n                //update score\n            setScore(updatedScore)\n\n            //remove card from objects\n            setCardState({\n                cardInHand:cardInHand.filter(item => item!=selectedCardValue),\n                cardImageUrl:cardImageUrl.filter(item => item!=srcImgCard)\n            })\n\n            //change turn\n            setTurn(!turn)\n        }\n      \n    }\n    \n\n    return {\n        score,\n        cardImageUrl,\n        //onButtonClick,\n        onCardClick,\n        result\n    }\n}"]},"metadata":{},"sourceType":"module"}