{"ast":null,"code":"import React, { useEffect, useState } from 'react';\nimport { cardsObjToArray, imagesObjToArray } from './utils';\nimport { createDeckAndDraw, drawCardFromDeck, drawFromDeck_2 } from './api';\nexport const useBoardGame = () => {\n  //states\n  //player1\n  const [{\n    cardImageUrl,\n    cardInHand\n  }, setCardState] = useState({\n    cardInHand: null,\n    cardImageUrl: null\n  }); // //player2\n  // const [{cardImageUrl_2,cardInHand_2}, setCardState_2] = useState({\n  //     cardInHand_2:null,\n  //     cardImageUrl_2:null\n  // })\n\n  const [deckId, setDeckId] = useState(null);\n  const [score, setScore] = useState(null); //turn\n\n  const [turn, setTurn] = useState(true);\n  const [winner, setWinner] = useState(); //handle ace \n\n  const [ace, setAce] = useState(null); //use effect sychonrous to prevent race conditions\n\n  useEffect(() => {\n    const fetchCardandDeck = async () => {\n      //draw 5 cards\n      const {\n        deckId,\n        cardsArray\n      } = await createDeckAndDraw(); //draw 5 cards for AI\n\n      const {\n        cardsArray: AIcardsArray\n      } = await drawFromDeck_2(deckId); //convert object to array of values\n\n      const cards = cardsObjToArray(cardsArray); //convert object to array of images\n\n      const images = imagesObjToArray(cardsArray); //     const cards2 = cardsArray2.map(obj => {\n      //         return obj.value\n      //     })\n      //     //convert object to array of images\n      //     const images2 = cardsArray2.map(obj => {\n      //        return obj.image\n      //    })\n\n      setCardState({\n        cardInHand: cards,\n        cardImageUrl: images\n      }); // setCardState_2({\n      //     cardInHand_2:cards2,\n      //     cardImageUrl_2:images2\n      // })\n\n      setDeckId(deckId);\n    };\n\n    fetchCardandDeck();\n  }, []);\n  useEffect(() => {\n    const fetchNewCard = async () => {\n      const {\n        value,\n        image\n      } = await drawCardFromDeck(deckId);\n      setCardState({\n        cardInHand: [...cardInHand, value],\n        cardImageUrl: [...cardImageUrl, image]\n      });\n    }; // const fetchNewCard2 = async () =>{\n    //     const {value,image} = await drawCardFromDeck(deckId);\n    //     setCardState_2({\n    //         cardInHand_2:[...cardInHand,value],\n    //         cardImageUrl_2:[...cardImageUrl,image]\n    //     })\n    // }\n\n\n    if (turn) {\n      fetchNewCard();\n    } // else{\n    //     fetchNewCard2();\n    // }\n\n  }, [turn]);\n\n  const handleAce = () => {\n    const aceValue = prompt(\"Please enter your ace value from 1-11\", \"1\");\n    return aceValue;\n  };\n\n  const onCardClick = event => {\n    if (turn) {\n      let srcImgCard = event.target.src;\n      let pos = cardImageUrl.indexOf(srcImgCard);\n      let selectedCardValue = cardInHand[pos];\n\n      if (selectedCardValue == '4') {\n        setCardState({\n          cardInHand: cardInHand.filter(item => item != selectedCardValue),\n          cardImageUrl: cardImageUrl.filter(item => item != srcImgCard)\n        }); //setTurn(!turn)\n\n        return;\n      } else if (selectedCardValue == '9') {\n        setCardState({\n          cardInHand: cardInHand.filter(item => item != selectedCardValue),\n          cardImageUrl: cardImageUrl.filter(item => item != srcImgCard)\n        }); // setTurn(!turn)\n\n        return;\n      } else if (selectedCardValue == '10') {\n        selectedCardValue = -10;\n      } else if (selectedCardValue == 'KING') {\n        selectedCardValue = 99 - Number(score);\n      } else if (selectedCardValue == 'QUEEN') {\n        selectedCardValue = 12;\n      } else if (selectedCardValue == 'JACK') {\n        selectedCardValue = 11;\n      } else if (selectedCardValue == 'ACE') {\n        selectedCardValue = handleAce();\n      }\n\n      let updatedScore = Number(score) + Number(selectedCardValue);\n\n      if (updatedScore > 99) {\n        alert(\"Winner Player 1 Refresh Game\");\n      } //update score\n\n\n      setScore(updatedScore); //remove card from objects\n\n      setCardState({\n        cardInHand: cardInHand.filter(item => item != selectedCardValue),\n        cardImageUrl: cardImageUrl.filter(item => item != srcImgCard)\n      }); //change turn\n      //setTurn(!turn)\n    } //player 2 turn\n    // else{\n    //     let srcImgCard = event.target.src\n    //     let pos = cardImageUrl_2.indexOf(srcImgCard)\n    //     let selectedCardValue = cardInHand_2[pos]\n    //     if(selectedCardValue=='4'){\n    //         setCardState_2({\n    //             cardInHand:cardInHand_2.filter(item => item!=selectedCardValue),\n    //             cardImageUrl:cardImageUrl_2.filter(item => item!=srcImgCard)\n    //         })\n    //         setTurn(!turn)\n    //         return\n    //     }\n    //     else if(selectedCardValue=='9'){\n    //         setCardState_2({\n    //             cardInHand:cardInHand_2.filter(item => item!=selectedCardValue),\n    //             cardImageUrl:cardImageUrl_2.filter(item => item!=srcImgCard)\n    //         })\n    //         setTurn(!turn)\n    //         return\n    //     }\n    //     else if(selectedCardValue=='10'){\n    //         selectedCardValue=-10\n    //     }\n    //     else if(selectedCardValue=='KING'){\n    //          selectedCardValue=99-Number(score)\n    //     }\n    //     else if(selectedCardValue=='QUEEN'){\n    //         selectedCardValue=12\n    //     }\n    //     else if(selectedCardValue=='JACK'){\n    //         selectedCardValue=11\n    //     }\n    //     else if(selectedCardValue=='ACE'){  \n    //         selectedCardValue=handleAce();\n    //     }\n    //     let updatedScore = Number(score)+Number(selectedCardValue)\n    //     debugger\n    //     if (updatedScore > 99){\n    //         alert(\"Winner player 2! Refresh Game\")\n    //     }\n    //     setScore(updatedScore)\n    //     //remove card from objects\n    //     setCardState_2({\n    //         cardInHand_2:cardInHand_2.filter(item => item!=selectedCardValue),\n    //         cardImageUrl_2:cardImageUrl_2.filter(item => item!=srcImgCard)\n    //     })\n    //     //change turn\n    //     setTurn(!turn)\n    // }\n\n  };\n\n  return {\n    score,\n    cardImageUrl,\n    //cardImageUrl_2,\n    //onButtonClick,\n    onCardClick,\n    turn,\n    winner\n  };\n};","map":{"version":3,"sources":["/Users/eddiezheng/Documents/GitHub/99/card/cardgame/src/cardGameBoard.state.js"],"names":["React","useEffect","useState","cardsObjToArray","imagesObjToArray","createDeckAndDraw","drawCardFromDeck","drawFromDeck_2","useBoardGame","cardImageUrl","cardInHand","setCardState","deckId","setDeckId","score","setScore","turn","setTurn","winner","setWinner","ace","setAce","fetchCardandDeck","cardsArray","AIcardsArray","cards","images","fetchNewCard","value","image","handleAce","aceValue","prompt","onCardClick","event","srcImgCard","target","src","pos","indexOf","selectedCardValue","filter","item","Number","updatedScore","alert"],"mappings":"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","sourcesContent":["import React, {useEffect,useState} from 'react'\nimport { cardsObjToArray, imagesObjToArray } from './utils'\nimport {createDeckAndDraw, drawCardFromDeck,drawFromDeck_2} from './api'\n\nexport const useBoardGame = () => {\n\n    //states\n    //player1\n    const [{cardImageUrl,cardInHand}, setCardState] = useState({\n        cardInHand:null,\n        cardImageUrl:null\n    })\n    // //player2\n    // const [{cardImageUrl_2,cardInHand_2}, setCardState_2] = useState({\n    //     cardInHand_2:null,\n    //     cardImageUrl_2:null\n    // })\n\n    const [deckId, setDeckId]=useState(null)\n    const [score,setScore]=useState(null)\n\n    //turn\n    const [turn,setTurn]=useState(true)\n    const [winner,setWinner]=useState()\n\n    //handle ace \n    const [ace,setAce]=useState(null)\n\n    //use effect sychonrous to prevent race conditions\n    useEffect(()=>{\n        const fetchCardandDeck = async () =>{\n\n            //draw 5 cards\n            const {deckId,cardsArray} = await createDeckAndDraw();\n\n            //draw 5 cards for AI\n             const {cardsArray:AIcardsArray} = await drawFromDeck_2(deckId);\n         \n               //convert object to array of values\n            \n             const cards =  cardsObjToArray(cardsArray)\n             \n\n             //convert object to array of images\n             const images = imagesObjToArray(cardsArray)\n        //     const cards2 = cardsArray2.map(obj => {\n        //         return obj.value\n        //     })\n\n        //     //convert object to array of images\n        //     const images2 = cardsArray2.map(obj => {\n        //        return obj.image\n        //    })\n            \n            setCardState({\n                cardInHand:cards,\n                cardImageUrl:images\n            })\n            // setCardState_2({\n            //     cardInHand_2:cards2,\n            //     cardImageUrl_2:images2\n            // })\n    \n            setDeckId(deckId);\n        }\n        fetchCardandDeck();\n    },[])\n\n    useEffect(()=>{\n\n            const fetchNewCard = async () =>{\n                const {value,image} = await drawCardFromDeck(deckId);\n                setCardState({\n                    cardInHand:[...cardInHand,value],\n                    cardImageUrl:[...cardImageUrl,image]\n                })\n            }\n            // const fetchNewCard2 = async () =>{\n            //     const {value,image} = await drawCardFromDeck(deckId);\n            //     setCardState_2({\n            //         cardInHand_2:[...cardInHand,value],\n            //         cardImageUrl_2:[...cardImageUrl,image]\n            //     })\n              \n            // }\n            if(turn){\n                fetchNewCard();\n            }\n            // else{\n            //     fetchNewCard2();\n            // }\n            \n    },[turn])\n\n    const handleAce = () =>{\n        const aceValue = prompt(\"Please enter your ace value from 1-11\", \"1\");\n        return aceValue;\n        \n    }\n\n    const onCardClick = (event) => {\n        if(turn)\n        {\n            let srcImgCard = event.target.src\n            let pos = cardImageUrl.indexOf(srcImgCard)\n            let selectedCardValue = cardInHand[pos]\n            \n            if(selectedCardValue=='4'){\n                setCardState({\n                    cardInHand:cardInHand.filter(item => item!=selectedCardValue),\n                    cardImageUrl:cardImageUrl.filter(item => item!=srcImgCard)\n                })\n                //setTurn(!turn)\n                return\n            }\n            else if(selectedCardValue=='9'){\n                setCardState({\n                    cardInHand:cardInHand.filter(item => item!=selectedCardValue),\n                    cardImageUrl:cardImageUrl.filter(item => item!=srcImgCard)\n                })\n               // setTurn(!turn)\n                return\n            }\n            else if(selectedCardValue=='10'){\n                selectedCardValue=-10\n            }\n            else if(selectedCardValue=='KING'){\n                 selectedCardValue=99-Number(score)\n            }\n            else if(selectedCardValue=='QUEEN'){\n                selectedCardValue=12\n            }\n            else if(selectedCardValue=='JACK'){\n                selectedCardValue=11\n            }\n            else if(selectedCardValue=='ACE'){\n\n                selectedCardValue=handleAce();\n            }\n\n            let updatedScore = Number(score)+Number(selectedCardValue)\n            \n            if (updatedScore > 99){\n               alert(\"Winner Player 1 Refresh Game\")\n            }\n\n                //update score\n            setScore(updatedScore)\n\n            //remove card from objects\n            setCardState({\n                cardInHand:cardInHand.filter(item => item!=selectedCardValue),\n                cardImageUrl:cardImageUrl.filter(item => item!=srcImgCard)\n            })\n\n            //change turn\n            //setTurn(!turn)\n        }\n        //player 2 turn\n        // else{\n        //     let srcImgCard = event.target.src\n        //     let pos = cardImageUrl_2.indexOf(srcImgCard)\n        //     let selectedCardValue = cardInHand_2[pos]\n        //     if(selectedCardValue=='4'){\n        //         setCardState_2({\n        //             cardInHand:cardInHand_2.filter(item => item!=selectedCardValue),\n        //             cardImageUrl:cardImageUrl_2.filter(item => item!=srcImgCard)\n        //         })\n        //         setTurn(!turn)\n        //         return\n        //     }\n        //     else if(selectedCardValue=='9'){\n        //         setCardState_2({\n        //             cardInHand:cardInHand_2.filter(item => item!=selectedCardValue),\n        //             cardImageUrl:cardImageUrl_2.filter(item => item!=srcImgCard)\n        //         })\n        //         setTurn(!turn)\n        //         return\n        //     }\n        //     else if(selectedCardValue=='10'){\n        //         selectedCardValue=-10\n        //     }\n        //     else if(selectedCardValue=='KING'){\n        //          selectedCardValue=99-Number(score)\n        //     }\n        //     else if(selectedCardValue=='QUEEN'){\n        //         selectedCardValue=12\n        //     }\n        //     else if(selectedCardValue=='JACK'){\n        //         selectedCardValue=11\n        //     }\n        //     else if(selectedCardValue=='ACE'){  \n\n        //         selectedCardValue=handleAce();\n        //     }\n\n    \n        //     let updatedScore = Number(score)+Number(selectedCardValue)\n        //     debugger\n        //     if (updatedScore > 99){\n        //         alert(\"Winner player 2! Refresh Game\")\n        //     }\n\n        //     setScore(updatedScore)\n\n        //     //remove card from objects\n        //     setCardState_2({\n        //         cardInHand_2:cardInHand_2.filter(item => item!=selectedCardValue),\n        //         cardImageUrl_2:cardImageUrl_2.filter(item => item!=srcImgCard)\n        //     })\n            \n        //     //change turn\n        //     setTurn(!turn)\n        // }\n      \n    }\n    \n\n    return {\n        score,\n        cardImageUrl,\n        //cardImageUrl_2,\n        //onButtonClick,\n        onCardClick,\n        turn,\n        winner,\n    }\n}"]},"metadata":{},"sourceType":"module"}