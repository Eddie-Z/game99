{"ast":null,"code":"import React, { useEffect, useState } from 'react';\nimport { compareValues } from './utils';\nimport { createDeckAndDraw, drawCardFromDeck, drawFromDeck_2 } from './api';\nexport const useBoardGame = () => {\n  //states\n  //player1\n  const [{\n    cardImageUrl,\n    cardInHand\n  }, setCardState] = useState({\n    cardInHand: null,\n    cardImageUrl: null\n  }); //player2\n\n  const [{\n    cardImageUrl_2,\n    cardInHand_2\n  }, setCardState_2] = useState({\n    cardInHand_2: null,\n    cardImageUrl_2: null\n  });\n  const [deckId, setDeckId] = useState(null);\n  const [score, setScore] = useState(null); //turn\n\n  const [turn, setTurn] = useState(true);\n  const [winner, setWinner] = useState(); //handle ace \n\n  const [ace, setAce] = useState(null); //use effect sychonrous to prevent race conditions\n\n  useEffect(() => {\n    const fetchCardandDeck = async () => {\n      const {\n        deckId,\n        cardsArray\n      } = await createDeckAndDraw();\n      const {\n        cardsArray: cardsArray2\n      } = await drawFromDeck_2(deckId);\n      console.log(cardsArray2); //convert object to array of values\n\n      const cards = cardsArray.map(obj => {\n        return obj.value;\n      }); //convert object to array of images\n\n      const images = cardsArray.map(obj => {\n        return obj.image;\n      });\n      const cards2 = cardsArray2.map(obj => {\n        return obj.value;\n      }); //convert object to array of images\n\n      const images2 = cardsArray2.map(obj => {\n        return obj.image;\n      });\n      setCardState({\n        cardInHand: cards,\n        cardImageUrl: images\n      });\n      setCardState_2({\n        cardInHand_2: cards2,\n        cardImageUrl_2: images2\n      });\n      setDeckId(deckId);\n    };\n\n    fetchCardandDeck();\n  }, []);\n  useEffect(() => {\n    const fetchNewCard = async () => {\n      const {\n        value,\n        image\n      } = await drawCardFromDeck(deckId);\n      setCardState({\n        cardInHand: [...cardInHand, value],\n        cardImageUrl: [...cardImageUrl, image]\n      });\n    };\n\n    const fetchNewCard2 = async () => {\n      const {\n        value,\n        image\n      } = await drawCardFromDeck(deckId);\n      setCardState_2({\n        cardInHand_2: [...cardInHand, value],\n        cardImageUrl_2: [...cardImageUrl, image]\n      });\n    };\n\n    if (turn) {\n      fetchNewCard();\n    } else {\n      fetchNewCard2();\n    }\n  }, [turn]);\n\n  const handleAce = event => {\n    prompt(\"Please enter your name\", \"Harry Potter\");\n  };\n\n  const onCardClick = event => {\n    if (turn) {\n      let srcImgCard = event.target.src;\n      let pos = cardImageUrl.indexOf(srcImgCard);\n      let selectedCardValue = cardInHand[pos];\n\n      if (selectedCardValue == '4') {\n        setTurn(!turn);\n      } else if (selectedCardValue == '9') {\n        setTurn(!turn);\n      } else if (selectedCardValue == '10') {\n        selectedCardValue = -10;\n      } else if (selectedCardValue == 'KING') {\n        selectedCardValue = 99 - Number(score);\n      } else if (selectedCardValue == 'QUEEN') {\n        selectedCardValue = 12;\n      } else if (selectedCardValue == 'JACK') {\n        selectedCardValue = 11;\n      } else if (selectedCardValue == 'ACE') {\n        selectedCardValue = handleAce();\n      }\n\n      let updatedScore = Number(score) + Number(selectedCardValue);\n\n      if (updatedScore > 99) {\n        setWinner(100);\n      } //update score\n\n\n      setScore(updatedScore); //remove card from objects\n\n      setCardState({\n        cardInHand: cardInHand.filter(item => item != selectedCardValue),\n        cardImageUrl: cardImageUrl.filter(item => item != srcImgCard)\n      }); //change turn\n\n      setTurn(!turn);\n    } //player 2 turn\n    else {\n        let srcImgCard = event.target.src;\n        let pos = cardImageUrl_2.indexOf(srcImgCard);\n        let selectedCardValue = cardInHand_2[pos];\n\n        if (selectedCardValue == '4') {\n          setTurn(!turn);\n        } else if (selectedCardValue == '9') {\n          setTurn(!turn);\n        } else if (selectedCardValue == '10') {\n          selectedCardValue = -10;\n        } else if (selectedCardValue == 'KING') {\n          selectedCardValue = 99 - Number(score);\n        } else if (selectedCardValue == 'QUEEN') {\n          selectedCardValue = 12;\n        } else if (selectedCardValue == 'JACK') {\n          selectedCardValue = 11;\n        } else if (selectedCardValue == 'ACE') {\n          selectedCardValue = handleAce();\n        }\n\n        console.log(selectedCardValue);\n        let updatedScore = Number(score) + Number(selectedCardValue);\n\n        if (updatedScore > 99) {\n          setWinner(101);\n        }\n\n        setScore(updatedScore); //remove card from objects\n\n        setCardState_2({\n          cardInHand_2: cardInHand.filter(item => item != selectedCardValue),\n          cardImageUrl_2: cardImageUrl.filter(item => item != srcImgCard)\n        }); //change turn\n\n        setTurn(!turn);\n      }\n  };\n\n  return {\n    score,\n    cardImageUrl,\n    cardImageUrl_2,\n    //onButtonClick,\n    onCardClick,\n    turn,\n    winner,\n    handleAce\n  };\n};","map":{"version":3,"sources":["/Users/eddiezheng/Documents/GitHub/99/card/cardgame/src/cardGameBoard.state.js"],"names":["React","useEffect","useState","compareValues","createDeckAndDraw","drawCardFromDeck","drawFromDeck_2","useBoardGame","cardImageUrl","cardInHand","setCardState","cardImageUrl_2","cardInHand_2","setCardState_2","deckId","setDeckId","score","setScore","turn","setTurn","winner","setWinner","ace","setAce","fetchCardandDeck","cardsArray","cardsArray2","console","log","cards","map","obj","value","images","image","cards2","images2","fetchNewCard","fetchNewCard2","handleAce","event","prompt","onCardClick","srcImgCard","target","src","pos","indexOf","selectedCardValue","Number","updatedScore","filter","item"],"mappings":"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","sourcesContent":["import React, {useEffect,useState} from 'react'\nimport { compareValues } from './utils'\nimport {createDeckAndDraw, drawCardFromDeck,drawFromDeck_2} from './api'\n\nexport const useBoardGame = () => {\n\n    //states\n    //player1\n    const [{cardImageUrl,cardInHand}, setCardState] = useState({\n        cardInHand:null,\n        cardImageUrl:null\n    })\n    //player2\n    const [{cardImageUrl_2,cardInHand_2}, setCardState_2] = useState({\n        cardInHand_2:null,\n        cardImageUrl_2:null\n    })\n\n    const [deckId, setDeckId]=useState(null)\n    const [score,setScore]=useState(null)\n\n    //turn\n    const [turn,setTurn]=useState(true)\n    const [winner,setWinner]=useState()\n\n    //handle ace \n    const [ace,setAce]=useState(null)\n\n    //use effect sychonrous to prevent race conditions\n    useEffect(()=>{\n        const fetchCardandDeck = async () =>{\n            const {deckId,cardsArray} = await createDeckAndDraw();\n            const {cardsArray:cardsArray2} = await drawFromDeck_2(deckId);\n            \n            console.log(cardsArray2)\n         \n               //convert object to array of values\n             const cards = cardsArray.map(obj => {\n                 return obj.value\n             })\n\n             //convert object to array of images\n             const images = cardsArray.map(obj => {\n                return obj.image\n            })\n            const cards2 = cardsArray2.map(obj => {\n                return obj.value\n            })\n\n            //convert object to array of images\n            const images2 = cardsArray2.map(obj => {\n               return obj.image\n           })\n            \n            setCardState({\n                cardInHand:cards,\n                cardImageUrl:images\n            })\n            setCardState_2({\n                cardInHand_2:cards2,\n                cardImageUrl_2:images2\n            })\n    \n            setDeckId(deckId);\n        }\n        fetchCardandDeck();\n    },[])\n\n    useEffect(()=>{\n\n            const fetchNewCard = async () =>{\n                const {value,image} = await drawCardFromDeck(deckId);\n                setCardState({\n                    cardInHand:[...cardInHand,value],\n                    cardImageUrl:[...cardImageUrl,image]\n                })\n              \n            }\n            const fetchNewCard2 = async () =>{\n                const {value,image} = await drawCardFromDeck(deckId);\n                setCardState_2({\n                    cardInHand_2:[...cardInHand,value],\n                    cardImageUrl_2:[...cardImageUrl,image]\n                })\n              \n            }\n            if(turn){\n                fetchNewCard();\n            }\n            else{\n                fetchNewCard2();\n            }\n            \n    },[turn])\n\n    const handleAce = (event) =>{\n        prompt(\"Please enter your name\", \"Harry Potter\");\n        \n    }\n\n    const onCardClick = (event) => {\n        \n        if(turn)\n        {\n            let srcImgCard = event.target.src\n            let pos = cardImageUrl.indexOf(srcImgCard)\n            let selectedCardValue = cardInHand[pos]\n\n            if(selectedCardValue=='4'){\n                setTurn(!turn)\n            }\n            else if(selectedCardValue=='9'){\n                setTurn(!turn)\n            }\n            else if(selectedCardValue=='10'){\n                selectedCardValue=-10\n            }\n            else if(selectedCardValue=='KING'){\n                 selectedCardValue=99-Number(score)\n            }\n            else if(selectedCardValue=='QUEEN'){\n                selectedCardValue=12\n            }\n            else if(selectedCardValue=='JACK'){\n                selectedCardValue=11\n            }\n            else if(selectedCardValue=='ACE'){\n\n                selectedCardValue=handleAce();\n            }\n\n            let updatedScore = Number(score)+Number(selectedCardValue)\n            if (updatedScore > 99){\n                setWinner(100)\n            }\n\n                //update score\n            setScore(updatedScore)\n\n            //remove card from objects\n            setCardState({\n                cardInHand:cardInHand.filter(item => item!=selectedCardValue),\n                cardImageUrl:cardImageUrl.filter(item => item!=srcImgCard)\n            })\n\n            //change turn\n            setTurn(!turn)\n        }\n        //player 2 turn\n        else{\n            let srcImgCard = event.target.src\n            let pos = cardImageUrl_2.indexOf(srcImgCard)\n            let selectedCardValue = cardInHand_2[pos]\n\n            if(selectedCardValue=='4'){\n                setTurn(!turn)\n            }\n            else if(selectedCardValue=='9'){\n                setTurn(!turn)\n            }\n            else if(selectedCardValue=='10'){\n                selectedCardValue=-10\n            }\n            else if(selectedCardValue=='KING'){\n                 selectedCardValue=99-Number(score)\n            }\n            else if(selectedCardValue=='QUEEN'){\n                selectedCardValue=12\n            }\n            else if(selectedCardValue=='JACK'){\n                selectedCardValue=11\n            }\n            else if(selectedCardValue=='ACE'){\n\n                selectedCardValue=handleAce();\n            }\n            console.log(selectedCardValue)\n    \n            let updatedScore = Number(score)+Number(selectedCardValue)\n            if (updatedScore > 99){\n                setWinner(101)\n            }\n\n            setScore(updatedScore)\n\n            //remove card from objects\n            setCardState_2({\n                cardInHand_2:cardInHand.filter(item => item!=selectedCardValue),\n                cardImageUrl_2:cardImageUrl.filter(item => item!=srcImgCard)\n            })\n            \n            //change turn\n            setTurn(!turn)\n        }\n      \n    }\n    \n\n    return {\n        score,\n        cardImageUrl,\n        cardImageUrl_2,\n        //onButtonClick,\n        onCardClick,\n        turn,\n        winner,\n        handleAce\n    }\n}"]},"metadata":{},"sourceType":"module"}